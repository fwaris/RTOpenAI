#r "nuget: Concentus.Native.NetCore, 1.5.2"
#r "nuget: Concentus, 2.2.2"
#r "nuget: FsPickler"
open System
open System.IO


let data = """
216
118
155
36
106
215
114
140
65
64
28
232
80
154
5
136
207
133
211
127
51
176
229
241
209
6
44
86
236
28
73
104
232
75
10
178
226
111
104
6
216
102
127
70
159
80
130
205
224
116
191
216
27
9
216
240
82
157
159
86
109
232
121
27
33
57
252
39
203
186
48
156
151
29
115
222
228
68
23
56
111
242
75
158
234
45
255
198
220
91
38
119
128
193
26
16
172
222
133
130
25
156
169
158
74
197
87
31
205
79
236
111
211
47
179
116
164
232
223
14
171
108
10
3
10
35
64
56
51
135
88
145
64
163
209
25
210
97
231
94
136
114
233
225
194
88
161
81
228
235
91
66
33
206
233
164
223
55
173
108
122
118
239
85
53
173
125
167
249
184
152
113
176
114
189
87
125
90
209
0
31
93
48
170
150
102
89
23
164
206
170
36
0
233
4
168
27
228
154
184
250
86
64
76
113
246
57
120
64
180
2
179
209
219
146
188
2
90
227
91
137
66
246
57
170
129
147
251
24
81
73
199
18
155
128
38
63
224
116
135
180
46
86
131
129
40
"""

let encodedData = 
    seq {
        use sstr = new StringReader(data)
        let mutable line = sstr.ReadLine()
        while line <> null do
            yield line
            line <- sstr.ReadLine()        
    }
    |> Seq.filter (System.String.IsNullOrWhiteSpace>>not)
    |> Seq.map byte
    |> Seq.toArray

let dec = Concentus.OpusCodecFactory.CreateDecoder(48000,1)
dec.s
let pcmData : float32[] =  Array.zeroCreate 5760;
let decodedDataLen = dec.Decode(encodedData,pcmData,pcmData.Length,true)
pcmData.[800..959]
decodedDataLen
let i1 = pcmData |> Array.findIndex (fun x -> x<>0.f)
pcmData.[120 .. 145]
